{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "summary": {
      "type": "string",
      "minLength": 10,
      "description": "2-4 предложения о сути общения и результате"
    },
    "keyPoints": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1,
      "maxItems": 7,
      "description": "3-7 ключевых тем/моментов обсуждения"
    },
    "tone": {
      "type": "string",
      "enum": ["positive", "neutral", "negative", "formal", "informal"],
      "description": "Эмоциональный тон переписки"
    },
    "decisions": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "Описание принятого решения"
          },
          "date": {
            "type": ["string", "null"],
            "description": "Дата/время решения если указано"
          },
          "importance": {
            "type": "string",
            "enum": ["high", "medium", "low"],
            "description": "Уровень важности решения"
          },
          "quote": {
            "type": ["string", "null"],
            "description": "Цитата из сообщения (до 100 символов)"
          }
        },
        "required": ["description", "importance"]
      },
      "description": "Принятые решения"
    },
    "actionItems": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "Описание задачи"
          },
          "owner": {
            "type": "string",
            "enum": ["self", "them", "both"],
            "description": "Кто должен выполнить: self=я, them=собеседник, both=совместно"
          },
          "status": {
            "type": "string",
            "enum": ["open", "closed"],
            "description": "Статус задачи"
          },
          "dueDate": {
            "type": ["string", "null"],
            "description": "Срок выполнения если указан"
          }
        },
        "required": ["description", "owner", "status"]
      },
      "description": "Задачи и обязательства"
    },
    "importantMessageIds": {
      "type": "array",
      "items": { "type": "string" },
      "description": "ID важных сообщений (даты, суммы, договорённости)"
    }
  },
  "required": ["summary", "keyPoints", "tone", "decisions", "actionItems"]
}
