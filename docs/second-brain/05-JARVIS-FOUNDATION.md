# Jarvis Foundation ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "–í—Ç–æ—Ä–æ–π –ü–∞–º—è—Ç–∏"

> –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

**–°—Ç–∞—Ç—É—Å:** Draft v2
**–î–∞—Ç–∞:** 2026-01-30
**–ö–ª—é—á–µ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ì–∏–±–∫–∞—è –º–æ–¥–µ–ª—å Activity –≤–º–µ—Å—Ç–æ –∂—ë—Å—Ç–∫–∏—Ö Project/Task

---

## Executive Summary

PKG —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –æ—Ç "—É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–µ—Ä–µ–ø–∏—Å–∫–µ" –∫ **–ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–º—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É** ("Jarvis"). –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Knowledge Graph** ‚Äî –≥–∏–±–∫–∞—è –º–æ–¥–µ–ª—å Activity + —Å–≤—è–∑–∏
2. **Reasoning Engine** ‚Äî –≤—ã–≤–æ–¥—ã, –∏–Ω—Ñ–µ—Ä–µ–Ω—Å, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **Trigger System** ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. **Action Engine** ‚Äî –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
5. **External Knowledge** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º

---

## –ß–∞—Å—Ç—å 1: –û–Ω—Ç–æ–ª–æ–≥–∏—è "–ñ–∏–∑–Ω—å —á–µ–ª–æ–≤–µ–∫–∞"

### 1.1 –§–∏–ª–æ—Å–æ—Ñ–∏—è –º–æ–¥–µ–ª–∏

–ñ–∏–∑–Ω—å —á–µ–ª–æ–≤–µ–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π** —Ä–∞–∑–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ –∏ –ø—Ä–∏—Ä–æ–¥—ã:

| –£—Ä–æ–≤–µ–Ω—å | –ü—Ä–∏–º–µ—Ä—ã | –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ |
|---------|---------|----------------|
| **–û–±–ª–∞—Å—Ç—å –∂–∏–∑–Ω–∏** | –†–∞–±–æ—Ç–∞, –°–µ–º—å—è, –ó–¥–æ—Ä–æ–≤—å–µ | –í–µ—á–Ω—ã–µ, –±–µ–∑ –¥–µ–¥–ª–∞–π–Ω–∞ |
| **–ë–∏–∑–Ω–µ—Å** | –ò–ò-–°–µ—Ä–≤–∏—Å—ã, –ì—É–≥–ª–®–∏—Ç—Å.—Ä—É | –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ, –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞ |
| **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** | –ö–∞–Ω–∞–ª, –°–∞–π—Ç, –ö–ª–∏–µ–Ω—Ç—ã | Ongoing –≤ —Ä–∞–º–∫–∞—Ö –±–∏–∑–Ω–µ—Å–∞ |
| **–ü—Ä–æ–µ–∫—Ç** | –•–∞–± –¥–ª—è –ü–∞–Ω–∞–≤—Ç–æ | –í—Ä–µ–º–µ–Ω–Ω—ã–π, –µ—Å—Ç—å —Ü–µ–ª—å –∏ –¥–µ–¥–ª–∞–π–Ω |
| **–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞** | –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∞—Ç—å—é | –õ–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –±–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞ |
| **–ó–∞–¥–∞—á–∞** | –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ–º–æ | –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ |

**–ü—Ä–∏–Ω—Ü–∏–ø:** –í—Å—ë —ç—Ç–æ ‚Äî **Activity** —Å —Ä–∞–∑–Ω—ã–º —Ç–∏–ø–æ–º. –ï–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å.

### 1.2 Core Entities

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         CORE ENTITIES                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   PERSON    ‚îÇ    ‚îÇORGANIZATION ‚îÇ    ‚îÇ       ACTIVITY          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ             ‚îÇ    ‚îÇ             ‚îÇ    ‚îÇ                         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ (—á–µ–ª–æ–≤–µ–∫)   ‚îÇ    ‚îÇ (–∫–æ–º–ø–∞–Ω–∏—è,  ‚îÇ    ‚îÇ business | direction |  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ             ‚îÇ    ‚îÇ  –≥—Ä—É–ø–ø–∞)    ‚îÇ    ‚îÇ project | initiative |  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ             ‚îÇ    ‚îÇ             ‚îÇ    ‚îÇ task | area | habit     ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ         ‚îÇ                  ‚îÇ                       ‚îÇ               ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ                            ‚îÇ                                        ‚îÇ
‚îÇ                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                               ‚îÇ
‚îÇ                    ‚îÇ  COMMITMENT   ‚îÇ                               ‚îÇ
‚îÇ                    ‚îÇ               ‚îÇ                               ‚îÇ
‚îÇ                    ‚îÇ (–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ‚îÇ                               ‚îÇ
‚îÇ                    ‚îÇ  –º–µ–∂–¥—É –ª—é–¥—å–º–∏)‚îÇ                               ‚îÇ
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                               ‚îÇ
‚îÇ                                                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ß–∞—Å—Ç—å 2: Activity ‚Äî –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å

### 2.1 Activity Entity

```typescript
// packages/entities/src/activity.entity.ts

import {
  Entity,
  PrimaryGeneratedColumn,
  Column,
  CreateDateColumn,
  UpdateDateColumn,
  ManyToOne,
  OneToMany,
  JoinColumn,
  Index,
  Tree,
  TreeChildren,
  TreeParent,
} from 'typeorm';
import { EntityRecord } from './entity.entity';

/**
 * –¢–∏–ø—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π ‚Äî —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π enum.
 * –ù–æ–≤—ã–µ —Ç–∏–ø—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
 */
export enum ActivityType {
  // –í–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
  AREA = 'area',                 // –û–±–ª–∞—Å—Ç—å –∂–∏–∑–Ω–∏: –†–∞–±–æ—Ç–∞, –°–µ–º—å—è, –ó–¥–æ—Ä–æ–≤—å–µ, –§–∏–Ω–∞–Ω—Å—ã
  BUSINESS = 'business',         // –ë–∏–∑–Ω–µ—Å/–∫–æ–º–ø–∞–Ω–∏—è: –ò–ò-–°–µ—Ä–≤–∏—Å—ã, –ì—É–≥–ª–®–∏—Ç—Å.—Ä—É

  // –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
  DIRECTION = 'direction',       // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ö–∞–Ω–∞–ª, –°–∞–π—Ç, –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞
  PROJECT = 'project',           // –ü—Ä–æ–µ–∫—Ç —Å —Ü–µ–ª—å—é –∏ –¥–µ–¥–ª–∞–π–Ω–æ–º
  INITIATIVE = 'initiative',     // –õ–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞ –±–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞

  // –ù–∏–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
  TASK = 'task',                 // –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞
  MILESTONE = 'milestone',       // –í–µ—Ö–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ

  // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ
  HABIT = 'habit',               // –ü—Ä–∏–≤—ã—á–∫–∞ (—Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
  LEARNING = 'learning',         // –û–±—É—á–µ–Ω–∏–µ (–∫—É—Ä—Å, –∫–Ω–∏–≥–∞)
  EVENT_SERIES = 'event_series', // –°–µ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏)
}

/**
 * –°—Ç–∞—Ç—É—Å—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π.
 * –°–µ–º–∞–Ω—Ç–∏–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
 */
export enum ActivityStatus {
  // –î–ª—è ongoing (area, business, direction, habit)
  ONGOING = 'ongoing',           // –ê–∫—Ç–∏–≤–Ω–æ –∏–¥—ë—Ç, –±–µ–∑ –∫–æ–Ω—Ü–∞

  // –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö (project, initiative, task)
  IDEA = 'idea',                 // –ò–¥–µ—è, –Ω–µ –Ω–∞—á–∞—Ç–æ
  PLANNED = 'planned',           // –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
  ACTIVE = 'active',             // –í —Ä–∞–±–æ—Ç–µ
  BLOCKED = 'blocked',           // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
  ON_HOLD = 'on_hold',           // –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
  COMPLETED = 'completed',       // –ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
  CANCELLED = 'cancelled',       // –û—Ç–º–µ–Ω–µ–Ω–æ

  // –î–ª—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
  ARCHIVED = 'archived',         // –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ (—Å–∫—Ä—ã—Ç–æ –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö)
}

/**
 * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã.
 */
export enum ActivityPriority {
  NONE = 'none',                 // –ë–µ–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (–¥–ª—è ongoing)
  LOW = 'low',
  NORMAL = 'normal',
  HIGH = 'high',
  URGENT = 'urgent',
}

/**
 * –ö–æ–Ω—Ç–µ–∫—Å—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
 */
export enum ActivityContext {
  WORK = 'work',
  PERSONAL = 'personal',
  FAMILY = 'family',
  FRIENDS = 'friends',
  HEALTH = 'health',
  FINANCE = 'finance',
  LEARNING = 'learning',
}

/**
 * Activity ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å –¥–ª—è –≤—Å–µ–≥–æ, —á–µ–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫.
 *
 * –ò–µ—Ä–∞—Ä—Ö–∏—è —á–µ—Ä–µ–∑ parent_id –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å –¥–µ—Ä–µ–≤—å—è –ª—é–±–æ–π –≥–ª—É–±–∏–Ω—ã:
 * - Area ‚Üí Business ‚Üí Direction ‚Üí Project ‚Üí Task
 * - Area ‚Üí Initiative ‚Üí Task
 * - Habit (–±–µ–∑ parent)
 */
@Entity('activities')
@Tree('closure-table') // –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏
export class Activity {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  // ==================== –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è ====================

  @Column({ length: 500 })
  @Index()
  name: string;

  @Column({ type: 'text', nullable: true })
  description: string | null;

  @Column({ name: 'activity_type', type: 'varchar', length: 30 })
  @Index()
  activityType: ActivityType;

  @Column({ type: 'varchar', length: 20, default: ActivityStatus.ACTIVE })
  @Index()
  status: ActivityStatus;

  @Column({ type: 'varchar', length: 20, default: ActivityPriority.NORMAL })
  priority: ActivityPriority;

  @Column({ type: 'varchar', length: 20, nullable: true })
  @Index()
  context: ActivityContext | null;

  // ==================== –ò–µ—Ä–∞—Ä—Ö–∏—è ====================

  @Column({ name: 'parent_id', type: 'uuid', nullable: true })
  @Index()
  parentId: string | null;

  @TreeParent()
  @ManyToOne(() => Activity, (a) => a.children, { nullable: true, onDelete: 'CASCADE' })
  @JoinColumn({ name: 'parent_id' })
  parent: Activity | null;

  @TreeChildren()
  @OneToMany(() => Activity, (a) => a.parent)
  children: Activity[];

  // ==================== –°–≤—è–∑–∏ —Å Entity ====================

  /**
   * –í–ª–∞–¥–µ–ª–µ—Ü –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–æ–±—ã—á–Ω–æ owner —Å–∏—Å—Ç–µ–º—ã).
   * –î–ª—è task –º–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä—É–≥–æ–π —á–µ–ª–æ–≤–µ–∫ (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ).
   */
  @Column({ name: 'owner_entity_id', type: 'uuid' })
  @Index()
  ownerEntityId: string;

  @ManyToOne(() => EntityRecord)
  @JoinColumn({ name: 'owner_entity_id' })
  owner: EntityRecord;

  /**
   * –ö–ª–∏–µ–Ω—Ç/–∑–∞–∫–∞–∑—á–∏–∫ (–¥–ª—è project, direction).
   * NULL –¥–ª—è –ª–∏—á–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤.
   */
  @Column({ name: 'client_entity_id', type: 'uuid', nullable: true })
  @Index()
  clientEntityId: string | null;

  @ManyToOne(() => EntityRecord, { nullable: true })
  @JoinColumn({ name: 'client_entity_id' })
  client: EntityRecord | null;

  /**
   * –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è, –æ—Ç –∏–º–µ–Ω–∏ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ–º).
   * –ù–∞–ø—Ä–∏–º–µ—Ä: –ì—É–≥–ª–®–∏—Ç—Å.—Ä—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.
   */
  @Column({ name: 'executor_entity_id', type: 'uuid', nullable: true })
  executorEntityId: string | null;

  @ManyToOne(() => EntityRecord, { nullable: true })
  @JoinColumn({ name: 'executor_entity_id' })
  executor: EntityRecord | null;

  // ==================== –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ ====================

  /**
   * –î–µ–¥–ª–∞–π–Ω (–¥–ª—è project, task, milestone).
   * NULL –¥–ª—è ongoing –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π.
   */
  @Column({ type: 'timestamp with time zone', nullable: true })
  @Index()
  deadline: Date | null;

  /**
   * –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞.
   */
  @Column({ name: 'start_date', type: 'timestamp with time zone', nullable: true })
  startDate: Date | null;

  /**
   * –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã.
   */
  @Column({ name: 'started_at', type: 'timestamp with time zone', nullable: true })
  startedAt: Date | null;

  /**
   * –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
   */
  @Column({ name: 'completed_at', type: 'timestamp with time zone', nullable: true })
  completedAt: Date | null;

  // ==================== –ò—Å—Ç–æ—á–Ω–∏–∫ ====================

  @Column({ type: 'varchar', length: 20, default: 'manual' })
  source: 'manual' | 'extracted' | 'inferred';

  /**
   * –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–¥–ª—è extracted/inferred).
   */
  @Column({ type: 'decimal', precision: 3, scale: 2, nullable: true })
  confidence: number | null;

  /**
   * –°–æ–æ–±—â–µ–Ω–∏–µ-–∏—Å—Ç–æ—á–Ω–∏–∫ (–æ—Ç–∫—É–¥–∞ –∏–∑–≤–ª–µ—á–µ–Ω–æ).
   */
  @Column({ name: 'source_message_id', type: 'uuid', nullable: true })
  sourceMessageId: string | null;

  /**
   * –¶–∏—Ç–∞—Ç–∞ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
   */
  @Column({ name: 'source_quote', type: 'text', nullable: true })
  sourceQuote: string | null;

  // ==================== –†–∞—Å—à–∏—Ä—è–µ–º—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ====================

  /**
   * –ì–∏–±–∫–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤.
   *
   * –ü—Ä–∏–º–µ—Ä—ã:
   * - learning: { platform: 'Coursera', progress: 45 }
   * - habit: { frequency: 'daily', streak: 12 }
   * - project: { budget: 100000, tags: ['integration', 'bitrix'] }
   */
  @Column({ type: 'jsonb', nullable: true })
  metadata: Record<string, unknown> | null;

  // ==================== Timestamps ====================

  @CreateDateColumn({ name: 'created_at' })
  createdAt: Date;

  @UpdateDateColumn({ name: 'updated_at' })
  updatedAt: Date;

  // ==================== –°–≤—è–∑–∏ (–±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã) ====================

  // @OneToMany(() => ActivityMember, (m) => m.activity)
  // members: ActivityMember[];

  // @OneToMany(() => Commitment, (c) => c.activity)
  // commitments: Commitment[];
}
```

### 2.2 Activity Members

```typescript
// packages/entities/src/activity-member.entity.ts

/**
 * –†–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
 */
export enum ActivityMemberRole {
  OWNER = 'owner',           // –í–ª–∞–¥–µ–ª–µ—Ü, –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  LEAD = 'lead',             // –õ–∏–¥–µ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è/–ø—Ä–æ–µ–∫—Ç–∞
  MEMBER = 'member',         // –£—á–∞—Å—Ç–Ω–∏–∫
  CONTRIBUTOR = 'contributor', // –í–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥, –Ω–æ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π
  STAKEHOLDER = 'stakeholder', // –ó–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ
  OBSERVER = 'observer',     // –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å
}

@Entity('activity_members')
@Index(['activityId', 'entityId'], { unique: true })
export class ActivityMember {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ name: 'activity_id', type: 'uuid' })
  @Index()
  activityId: string;

  @ManyToOne(() => Activity, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'activity_id' })
  activity: Activity;

  @Column({ name: 'entity_id', type: 'uuid' })
  @Index()
  entityId: string;

  @ManyToOne(() => EntityRecord, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'entity_id' })
  entity: EntityRecord;

  @Column({ type: 'varchar', length: 30 })
  role: ActivityMemberRole;

  /**
   * –ó–æ–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–º–∫–∞—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
   * –ü—Ä–∏–º–µ—Ä: "API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è", "–î–∏–∑–∞–π–Ω", "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
   */
  @Column({ type: 'varchar', length: 200, nullable: true })
  responsibility: string | null;

  @Column({ name: 'joined_at', type: 'timestamp with time zone', default: () => 'CURRENT_TIMESTAMP' })
  joinedAt: Date;

  @Column({ name: 'left_at', type: 'timestamp with time zone', nullable: true })
  leftAt: Date | null;
}
```

### 2.3 Commitment (–û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)

```typescript
// packages/entities/src/commitment.entity.ts

export enum CommitmentType {
  PROMISE = 'promise',       // "–Ø —Å–¥–µ–ª–∞—é X"
  REQUEST = 'request',       // "–°–¥–µ–ª–∞–π X"
  AGREEMENT = 'agreement',   // "–î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –æ X"
  DEADLINE = 'deadline',     // "X –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≥–æ—Ç–æ–≤–æ –∫ Y"
  FOLLOW_UP = 'follow_up',   // "–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ X —á–µ—Ä–µ–∑ Y"
}

export enum CommitmentStatus {
  ACTIVE = 'active',
  FULFILLED = 'fulfilled',
  BROKEN = 'broken',
  CANCELLED = 'cancelled',
  EXPIRED = 'expired',
}

@Entity('commitments')
export class Commitment {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  /**
   * –ß—Ç–æ –æ–±–µ—â–∞–Ω–æ/—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ.
   */
  @Column({ type: 'text' })
  what: string;

  @Column({ type: 'varchar', length: 30 })
  type: CommitmentType;

  @Column({ type: 'varchar', length: 20, default: CommitmentStatus.ACTIVE })
  @Index()
  status: CommitmentStatus;

  // ==================== –£—á–∞—Å—Ç–Ω–∏–∫–∏ ====================

  /**
   * –ö—Ç–æ –¥–∞–ª –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ.
   */
  @Column({ name: 'from_entity_id', type: 'uuid' })
  @Index()
  fromEntityId: string;

  @ManyToOne(() => EntityRecord)
  @JoinColumn({ name: 'from_entity_id' })
  fromEntity: EntityRecord;

  /**
   * –ö–æ–º—É –¥–∞–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ.
   */
  @Column({ name: 'to_entity_id', type: 'uuid' })
  @Index()
  toEntityId: string;

  @ManyToOne(() => EntityRecord)
  @JoinColumn({ name: 'to_entity_id' })
  toEntity: EntityRecord;

  // ==================== –°–≤—è–∑–∏ ====================

  /**
   * –í —Ä–∞–º–∫–∞—Ö –∫–∞–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
   */
  @Column({ name: 'activity_id', type: 'uuid', nullable: true })
  @Index()
  activityId: string | null;

  @ManyToOne(() => Activity, { nullable: true, onDelete: 'SET NULL' })
  @JoinColumn({ name: 'activity_id' })
  activity: Activity | null;

  // ==================== –°—Ä–æ–∫–∏ ====================

  @Column({ type: 'timestamp with time zone', nullable: true })
  @Index()
  deadline: Date | null;

  @Column({ name: 'fulfilled_at', type: 'timestamp with time zone', nullable: true })
  fulfilledAt: Date | null;

  // ==================== –ò—Å—Ç–æ—á–Ω–∏–∫ ====================

  @Column({ name: 'source_message_id', type: 'uuid', nullable: true })
  sourceMessageId: string | null;

  @Column({ name: 'source_quote', type: 'text', nullable: true })
  sourceQuote: string | null;

  @Column({ type: 'varchar', length: 20, default: 'extracted' })
  source: 'manual' | 'extracted' | 'inferred';

  @Column({ type: 'decimal', precision: 3, scale: 2, nullable: true })
  confidence: number | null;

  // ==================== Timestamps ====================

  @CreateDateColumn({ name: 'created_at' })
  createdAt: Date;

  @UpdateDateColumn({ name: 'updated_at' })
  updatedAt: Date;
}
```

---

## –ß–∞—Å—Ç—å 3: –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### 3.1 –¢–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å

```sql
-- activities table
INSERT INTO activities (id, name, activity_type, status, parent_id, context, owner_entity_id) VALUES
-- –û–±–ª–∞—Å—Ç–∏ –∂–∏–∑–Ω–∏
('A0', '–†–∞–±–æ—Ç–∞', 'area', 'ongoing', NULL, 'work', 'owner-uuid'),
('A0b', '–°–µ–º—å—è', 'area', 'ongoing', NULL, 'family', 'owner-uuid'),

-- –ë–∏–∑–Ω–µ—Å—ã
('A1', '–ò–ò-–°–µ—Ä–≤–∏—Å—ã', 'business', 'ongoing', 'A0', 'work', 'owner-uuid'),
('A2', '–ì—É–≥–ª–®–∏—Ç—Å.—Ä—É', 'business', 'ongoing', 'A0', 'work', 'owner-uuid'),

-- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ì—É–≥–ª–®–∏—Ç—Å.—Ä—É
('A3', '–ö–∞–Ω–∞–ª', 'direction', 'ongoing', 'A2', 'work', 'owner-uuid'),
('A4', '–°–∞–π—Ç', 'direction', 'ongoing', 'A2', 'work', 'owner-uuid'),
('A5', '–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞', 'direction', 'ongoing', 'A2', 'work', 'owner-uuid'),

-- –ü—Ä–æ–µ–∫—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
('A6', '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤', 'project', 'active', 'A5', 'work', 'owner-uuid'),
('A7', '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM', 'project', 'planned', 'A5', 'work', 'owner-uuid'),
('A8', 'Dashboard', 'project', 'active', 'A5', 'work', 'owner-uuid'),

-- –ü—Ä–æ–µ–∫—Ç—ã –ò–ò-–°–µ—Ä–≤–∏—Å—ã
('A9', '–•–∞–± –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å24', 'project', 'active', 'A1', 'work', 'owner-uuid'),
('A10', '–°–∫–æ—Ä–∏–Ω–≥ –∑–≤–æ–Ω–∫–æ–≤', 'project', 'active', 'A1', 'work', 'owner-uuid'),

-- –ó–∞–¥–∞—á–∏
('T1', '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ–º–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏', 'task', 'active', 'A9', 'work', 'owner-uuid'),
('T2', '–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å—Ç –ø—Ä–æ QUERY', 'task', 'planned', 'A3', 'work', 'owner-uuid');

-- –ö–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–æ–≤
UPDATE activities SET client_entity_id = 'client-a-uuid' WHERE id IN ('A6', 'A7');
UPDATE activities SET client_entity_id = 'client-b-uuid' WHERE id = 'A8';
UPDATE activities SET client_entity_id = 'panavto-uuid' WHERE id = 'A9';

-- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
UPDATE activities SET executor_entity_id = 'googlesheets-ru-uuid' WHERE parent_id = 'A5';
UPDATE activities SET executor_entity_id = 'ii-services-uuid' WHERE id IN ('A9', 'A10');
```

### 3.2 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏

```
–†–∞–±–æ—Ç–∞ (area)
‚îú‚îÄ‚îÄ –ò–ò-–°–µ—Ä–≤–∏—Å—ã (business)
‚îÇ   ‚îú‚îÄ‚îÄ –•–∞–± –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å24 (project) ‚Üí –∫–ª–∏–µ–Ω—Ç: –ü–∞–Ω–∞–≤—Ç–æ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ–º–æ (task)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¢–ó (task)
‚îÇ   ‚îî‚îÄ‚îÄ –°–∫–æ—Ä–∏–Ω–≥ –∑–≤–æ–Ω–∫–æ–≤ (project) ‚Üí –∫–ª–∏–µ–Ω—Ç: –õ–∞—Å—Ñ–ª–æ—Ä
‚îÇ
‚îî‚îÄ‚îÄ –ì—É–≥–ª–®–∏—Ç—Å.—Ä—É (business)
    ‚îú‚îÄ‚îÄ –ö–∞–Ω–∞–ª (direction)
    ‚îÇ   ‚îî‚îÄ‚îÄ –ù–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å—Ç –ø—Ä–æ QUERY (task)
    ‚îú‚îÄ‚îÄ –°–∞–π—Ç (direction)
    ‚îî‚îÄ‚îÄ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ (direction)
        ‚îú‚îÄ‚îÄ [–ö–ª–∏–µ–Ω—Ç –ê] –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (project)
        ‚îú‚îÄ‚îÄ [–ö–ª–∏–µ–Ω—Ç –ê] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CRM (project)
        ‚îî‚îÄ‚îÄ [–ö–ª–∏–µ–Ω—Ç –ë] Dashboard (project)

–°–µ–º—å—è (area)
‚îú‚îÄ‚îÄ –†–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä—ã (project)
‚îî‚îÄ‚îÄ –û—Ç–ø—É—Å–∫ –≤ –∞–≤–≥—É—Å—Ç–µ (initiative)
```

---

## –ß–∞—Å—Ç—å 4: –ó–∞–ø—Ä–æ—Å—ã –∏ API

### 4.1 –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```typescript
// ActivityService

/**
 * –ü–æ–ª—É—á–∏—Ç—å –≤—Å—ë –¥–µ—Ä–µ–≤–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
 */
async getActivityTree(rootId?: string): Promise<Activity[]> {
  const repo = this.activityRepo.manager.getTreeRepository(Activity);
  if (rootId) {
    const root = await repo.findOne({ where: { id: rootId } });
    return repo.findDescendantsTree(root);
  }
  return repo.findTrees();
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å –¥–µ–¥–ª–∞–π–Ω–∞–º–∏
 */
async getActiveProjectsWithDeadlines(): Promise<Activity[]> {
  return this.activityRepo.find({
    where: {
      activityType: In([ActivityType.PROJECT, ActivityType.TASK]),
      status: In([ActivityStatus.ACTIVE, ActivityStatus.PLANNED]),
      deadline: Not(IsNull()),
    },
    order: { deadline: 'ASC' },
    relations: ['client', 'parent'],
  });
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –≤—Å—ë –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (work/personal)
 */
async getByContext(context: ActivityContext): Promise<Activity[]> {
  return this.activityRepo.find({
    where: { context, status: Not(ActivityStatus.ARCHIVED) },
    relations: ['children'],
  });
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º
 */
async getProjectsByClient(clientEntityId: string): Promise<Activity[]> {
  return this.activityRepo.find({
    where: {
      clientEntityId,
      activityType: ActivityType.PROJECT,
      status: Not(In([ActivityStatus.COMPLETED, ActivityStatus.CANCELLED, ActivityStatus.ARCHIVED])),
    },
  });
}

/**
 * –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏—é (–¥–ª—è inference)
 */
async findByMention(mention: string): Promise<Activity | null> {
  // Fuzzy search –ø–æ –∏–º–µ–Ω–∏
  return this.activityRepo
    .createQueryBuilder('a')
    .where('a.name ILIKE :pattern', { pattern: `%${mention}%` })
    .andWhere('a.status NOT IN (:...statuses)', {
      statuses: [ActivityStatus.ARCHIVED, ActivityStatus.CANCELLED],
    })
    .getOne();
}
```

### 4.2 Tools –¥–ª—è Claude Agent

```typescript
// ActivityToolsProvider

const activityTools = [
  tool(
    'list_activities',
    'List activities with filters. Use to find projects, tasks, directions.',
    {
      type: z.enum(['all', 'area', 'business', 'direction', 'project', 'task'])
        .optional()
        .describe('Filter by activity type'),
      context: z.enum(['work', 'personal', 'family'])
        .optional()
        .describe('Filter by life context'),
      status: z.enum(['active', 'planned', 'completed', 'all'])
        .optional()
        .default('active')
        .describe('Filter by status'),
      parentId: z.string().uuid().optional()
        .describe('Get children of specific activity'),
      clientId: z.string().uuid().optional()
        .describe('Filter by client entity'),
    },
    async (args) => {
      const activities = await this.activityService.list(args);
      return toolSuccess(activities);
    }
  ),

  tool(
    'get_activity_tree',
    'Get full hierarchy tree of an activity with all descendants',
    {
      activityId: z.string().uuid().describe('Root activity ID'),
    },
    async (args) => {
      const tree = await this.activityService.getActivityTree(args.activityId);
      return toolSuccess(tree);
    }
  ),

  tool(
    'create_activity',
    'Create new activity (project, task, etc). Requires user confirmation.',
    {
      name: z.string().describe('Activity name'),
      type: z.enum(['project', 'task', 'initiative', 'direction'])
        .describe('Activity type'),
      parentId: z.string().uuid().optional()
        .describe('Parent activity ID'),
      clientId: z.string().uuid().optional()
        .describe('Client entity ID for client projects'),
      deadline: z.string().optional()
        .describe('Deadline in ISO format'),
      context: z.enum(['work', 'personal', 'family']).optional()
        .describe('Life context'),
    },
    async (args) => {
      // –°–æ–∑–¥–∞—ë—Ç pending_confirmation, –Ω–µ —Å—Ä–∞–∑—É activity
      const pending = await this.confirmationService.createActivityConfirmation(args);
      return toolSuccess({
        message: 'Activity creation requires confirmation',
        confirmationId: pending.id,
        preview: args,
      });
    }
  ),

  tool(
    'update_activity_status',
    'Update activity status (complete, cancel, pause)',
    {
      activityId: z.string().uuid().describe('Activity ID'),
      status: z.enum(['active', 'completed', 'cancelled', 'on_hold'])
        .describe('New status'),
    },
    async (args) => {
      await this.activityService.updateStatus(args.activityId, args.status);
      return toolSuccess({ message: 'Status updated' });
    }
  ),

  tool(
    'get_deadlines',
    'Get upcoming deadlines for projects and tasks',
    {
      days: z.number().int().min(1).max(90).default(7)
        .describe('Number of days to look ahead'),
      context: z.enum(['work', 'personal', 'all']).optional()
        .describe('Filter by context'),
    },
    async (args) => {
      const deadlines = await this.activityService.getUpcomingDeadlines(args.days, args.context);
      return toolSuccess(deadlines);
    }
  ),
];
```

---

## –ß–∞—Å—Ç—å 5: Reasoning Engine

### 5.1 Inference Rules

```typescript
// InferenceService

interface InferenceRule {
  id: string;
  name: string;
  trigger: InferenceTrigger;
  conditions: InferenceCondition[];
  actions: InferenceAction[];
  confidence: number;
}

// –ü—Ä–∞–≤–∏–ª–æ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏
const projectInferenceRule: InferenceRule = {
  id: 'infer-project-from-conversation',
  name: 'Detect project from conversation patterns',
  trigger: {
    type: 'message_pattern',
    patterns: [
      '—Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥',
      '–ø—Ä–æ–µ–∫—Ç –ø–æ',
      '–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è',
      '–∑–∞–∫–∞–∑ –æ—Ç',
      '–∫–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç',
    ],
  },
  conditions: [
    { type: 'mentions_multiple_people', minCount: 2 },
    { type: 'mentions_deliverable_or_deadline' },
    { type: 'no_existing_activity_matches' },
  ],
  actions: [
    {
      type: 'suggest_activity_creation',
      activityType: 'project',
      extractFields: ['name', 'client', 'participants', 'deadline'],
    },
  ],
  confidence: 0.7,
};

// –ü—Ä–∞–≤–∏–ª–æ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const contextInferenceRule: InferenceRule = {
  id: 'infer-context',
  name: 'Determine work/personal context',
  trigger: { type: 'new_interaction' },
  conditions: [],
  actions: [
    {
      type: 'set_context',
      logic: `
        IF entity.organizationId === owner.organizationId THEN 'work'
        ELSE IF entity has CLIENT_VENDOR with owner.org THEN 'work'
        ELSE IF entity has FAMILY relation THEN 'family'
        ELSE IF entity has FRIENDSHIP relation THEN 'personal'
        ELSE NULL
      `,
    },
  ],
  confidence: 0.9,
};

// –ü—Ä–∞–≤–∏–ª–æ 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
const taskExtractionRule: InferenceRule = {
  id: 'extract-task-from-message',
  name: 'Extract task from message',
  trigger: {
    type: 'message_pattern',
    patterns: [
      '–Ω—É–∂–Ω–æ ',
      '–Ω–∞–¥–æ ',
      '—Å–¥–µ–ª–∞–π ',
      '–ø–æ–¥–≥–æ—Ç–æ–≤—å ',
      '–Ω–∞–ø–∏—à–∏ ',
      '–æ—Ç–ø—Ä–∞–≤—å ',
    ],
  },
  conditions: [
    { type: 'is_actionable' },
    { type: 'has_clear_deliverable' },
  ],
  actions: [
    {
      type: 'suggest_activity_creation',
      activityType: 'task',
      extractFields: ['name', 'deadline', 'assignee'],
      linkToParent: 'infer_from_context', // –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –Ω–∞–π—Ç–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π project
    },
  ],
  confidence: 0.6,
};
```

### 5.2 Daily Synthesis ‚Üí Structured Extraction

```typescript
// DailySynthesisExtractionService

interface DailySynthesisOutput {
  // –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (–Ω–æ–≤—ã–µ –∏–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã–µ)
  projects: {
    name: string;
    isNew: boolean;
    existingActivityId?: string;
    participants: string[];
    client?: string;
    status?: string;
  }[];

  // –ò–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
  tasks: {
    title: string;
    projectName?: string;
    deadline?: string;
    assignee?: 'self' | string;
    status: 'pending' | 'done';
  }[];

  // –û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
  commitments: {
    what: string;
    from: string;
    to: string;
    deadline?: string;
    type: CommitmentType;
  }[];

  // –ò–Ω—Ñ–µ—Ä–µ–Ω—Å —Å–≤—è–∑–µ–π
  inferredRelations: {
    type: 'project_member' | 'works_on' | 'client_of';
    entities: string[];
    confidence: number;
  }[];
}

async extractFromDailySynthesis(dailyText: string): Promise<DailySynthesisOutput> {
  const result = await this.claudeAgent.call({
    mode: 'oneshot',
    prompt: `
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π daily-–æ—Ç—á—ë—Ç –∏ –∏–∑–≤–ª–µ–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

DAILY –û–¢–ß–Å–¢:
${dailyText}

–ò–∑–≤–ª–µ–∫–∏:
1. –ü–†–û–ï–ö–¢–´ ‚Äî —É–ø–æ–º—è–Ω—É—Ç—ã–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ –≤–µ–¥—ë—Ç—Å—è —Ä–∞–±–æ—Ç–∞
2. –ó–ê–î–ê–ß–ò ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ)
3. –û–ë–Ø–ó–ê–¢–ï–õ–¨–°–¢–í–ê ‚Äî –∫—Ç–æ –∫–æ–º—É —á—Ç–æ –æ–±–µ—â–∞–ª
4. –°–í–Ø–ó–ò ‚Äî –∫—Ç–æ —Å –∫–µ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ —á–µ–º

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —É–∫–∞–∂–∏ confidence (0-1).
`,
    outputFormat: {
      type: 'json_schema',
      schema: DAILY_EXTRACTION_SCHEMA,
      strict: true,
    },
  });

  return result.data as DailySynthesisOutput;
}
```

---

## –ß–∞—Å—Ç—å 6: Trigger System

### 6.1 Trigger Types

```typescript
export enum TriggerType {
  // Time-based
  SCHEDULED = 'scheduled',
  DEADLINE_APPROACHING = 'deadline_approaching',
  DEADLINE_PASSED = 'deadline_passed',
  PERIODIC = 'periodic', // –î–ª—è habits

  // Event-based
  INCOMING_CALL = 'incoming_call',
  INCOMING_MESSAGE = 'incoming_message',
  ACTIVITY_STATUS_CHANGED = 'activity_status_changed',

  // Context-based
  MEETING_STARTING = 'meeting_starting',
  WORKING_HOURS_START = 'working_hours_start',
  WORKING_HOURS_END = 'working_hours_end',

  // Anomaly-based
  COMMITMENT_OVERDUE = 'commitment_overdue',
  UNUSUAL_SILENCE = 'unusual_silence',
  BLOCKED_TOO_LONG = 'blocked_too_long',
}
```

### 6.2 Example Triggers

```typescript
// –¢—Ä–∏–≥–≥–µ—Ä: –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –¥–µ–¥–ª–∞–π–Ω
{
  type: TriggerType.DEADLINE_APPROACHING,
  conditions: {
    daysUntil: [3, 1, 0], // –ó–∞ 3 –¥–Ω—è, –∑–∞ 1 –¥–µ–Ω—å, –≤ –¥–µ–Ω—å
    activityTypes: ['project', 'task'],
    statuses: ['active', 'planned'],
  },
  actions: [{
    type: 'notify',
    template: 'deadline_reminder',
    channel: 'telegram',
    data: {
      includeBlockers: true,
      suggestActions: ['complete', 'extend', 'delegate'],
    },
  }],
}

// –¢—Ä–∏–≥–≥–µ—Ä: –≤—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
{
  type: TriggerType.INCOMING_CALL,
  conditions: {
    entityHasActivities: true, // –ï—Å—Ç—å –æ–±—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã/–∑–∞–¥–∞—á–∏
  },
  actions: [{
    type: 'notify',
    template: 'call_context',
    channel: 'telegram',
    priority: 'high',
    data: {
      includeOpenCommitments: true,
      includeRecentTopics: true,
      includeSharedActivities: true,
    },
  }],
}

// –¢—Ä–∏–≥–≥–µ—Ä: –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ
{
  type: TriggerType.COMMITMENT_OVERDUE,
  conditions: {
    daysOverdue: 1,
    commitmentTypes: ['promise', 'deadline'],
  },
  actions: [{
    type: 'notify',
    template: 'commitment_overdue',
    data: {
      suggestActions: ['remind_them', 'mark_cancelled', 'extend'],
    },
  }],
}
```

---

## –ß–∞—Å—Ç—å 7: Action Engine

### 7.1 Action Types

```typescript
export enum ActionType {
  // Communication
  DRAFT_MESSAGE = 'draft_message',
  SEND_MESSAGE = 'send_message',
  SCHEDULE_MESSAGE = 'schedule_message',

  // Activity Management
  CREATE_ACTIVITY = 'create_activity',
  UPDATE_ACTIVITY = 'update_activity',
  COMPLETE_ACTIVITY = 'complete_activity',
  DELEGATE_ACTIVITY = 'delegate_activity',

  // Commitment Management
  CREATE_COMMITMENT = 'create_commitment',
  FULFILL_COMMITMENT = 'fulfill_commitment',
  REMIND_COMMITMENT = 'remind_commitment',

  // Knowledge Management
  CREATE_FACT = 'create_fact',
  LINK_ENTITIES = 'link_entities',
  ADD_ACTIVITY_MEMBER = 'add_activity_member',

  // External
  SEARCH_WEB = 'search_web',
  FETCH_DOCS = 'fetch_docs',
}

// –£—Ä–æ–≤–Ω–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏
export enum ActionAutonomy {
  AUTO = 'auto',           // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
  CONFIRM = 'confirm',     // –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
  SUGGEST = 'suggest',     // –¢–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è
  FORBIDDEN = 'forbidden', // –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Å–∏—Å—Ç–µ–º–æ–π
}

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏ –ø–æ —Ç–∏–ø–∞–º
const ACTION_AUTONOMY: Record<ActionType, ActionAutonomy> = {
  // Auto ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
  [ActionType.CREATE_FACT]: ActionAutonomy.AUTO, // –ï—Å–ª–∏ confidence > 0.9
  [ActionType.SEARCH_WEB]: ActionAutonomy.AUTO,

  // Confirm ‚Äî —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
  [ActionType.SEND_MESSAGE]: ActionAutonomy.CONFIRM,
  [ActionType.CREATE_ACTIVITY]: ActionAutonomy.CONFIRM,
  [ActionType.COMPLETE_ACTIVITY]: ActionAutonomy.CONFIRM,
  [ActionType.DELEGATE_ACTIVITY]: ActionAutonomy.CONFIRM,

  // Suggest ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
  [ActionType.DRAFT_MESSAGE]: ActionAutonomy.SUGGEST,
  [ActionType.REMIND_COMMITMENT]: ActionAutonomy.SUGGEST,
};
```

### 7.2 Approval Flow in Telegram

```typescript
// –ü—Ä–∏–º–µ—Ä: —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

async suggestProjectCreation(inference: ProjectInference): Promise<void> {
  const message = `
üîç **–û–±–Ω–∞—Ä—É–∂–µ–Ω –≤–æ–∑–º–æ–∂–Ω—ã–π –ø—Ä–æ–µ–∫—Ç**

**${inference.name}**
${inference.client ? `–ö–ª–∏–µ–Ω—Ç: ${inference.client}` : ''}
${inference.participants.length ? `–£—á–∞—Å—Ç–Ω–∏–∫–∏: ${inference.participants.join(', ')}` : ''}
${inference.deadline ? `–î–µ–¥–ª–∞–π–Ω: ${formatDate(inference.deadline)}` : ''}

_–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ${Math.round(inference.confidence * 100)}%_
_–ò—Å—Ç–æ—á–Ω–∏–∫: –ø–µ—Ä–µ–ø–∏—Å–∫–∞ —Å ${inference.sourceEntity}_
`;

  await this.telegram.sendMessage(ownerId, message, {
    reply_markup: {
      inline_keyboard: [
        [
          { text: '‚úÖ –°–æ–∑–¥–∞—Ç—å', callback_data: `act_create_${inference.id}` },
          { text: '‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å', callback_data: `act_edit_${inference.id}` },
        ],
        [
          { text: '‚ùå –ù–µ –ø—Ä–æ–µ–∫—Ç', callback_data: `act_reject_${inference.id}` },
          { text: 'üîá –ò–≥–Ω–æ—Ä', callback_data: `act_ignore_${inference.id}` },
        ],
      ],
    },
  });
}
```

---

## –ß–∞—Å—Ç—å 8: External Knowledge

### 8.1 Integration Architecture

```typescript
// ExternalKnowledgeService

async augmentAnswer(
  question: string,
  internalContext: InternalContext,
): Promise<AugmentedAnswer> {
  // 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω—É–∂–Ω—ã –ª–∏ –≤–Ω–µ—à–Ω–∏–µ –∑–Ω–∞–Ω–∏—è
  const needsExternal = await this.assessExternalNeed(question, internalContext);

  if (!needsExternal) {
    return { answer: internalContext.synthesis, sources: internalContext.sources };
  }

  // 2. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  const queries = await this.generateSearchQueries(question, internalContext);

  // 3. –ü–æ–ª—É—á–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ
  const externalData = await Promise.all([
    this.webSearch(queries.general),
    this.fetchDocs(queries.documentation),
    this.findExamples(queries.examples),
  ]);

  // 4. –°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
  return this.synthesizeAnswer(question, internalContext, externalData);
}
```

### 8.2 Example: Question about Bitrix24 Integration

```
User: "–ö–∞–∫ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ë–∏—Ç—Ä–∏–∫—Å24?"

Internal Context:
- Project "–•–∞–± –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å24" exists
- Participants: –ú–∞—à–∞, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞, –°–µ—Ä–≥–µ–π (–ü–∞–Ω–∞–≤—Ç–æ)
- Recent discussions about REST API

External Augmentation:
- Bitrix24 REST API documentation
- Best practices from community
- Rate limits, authentication methods

Synthesized Answer:
"–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ '–•–∞–± –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å24' (–∫–ª–∏–µ–Ω—Ç: –ü–∞–Ω–∞–≤—Ç–æ) —Ä–µ–∫–æ–º–µ–Ω–¥—É—é:

**–ò–∑ –≤–∞—à–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- –ú–∞—à–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å –º–µ—Ç–æ–¥–æ–º crm.lead.add
- –°–µ—Ä–≥–µ–π –ø—Ä–æ—Å–∏–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Bitrix24:**
- REST API rate limit: 2 req/sec
- –ò—Å–ø–æ–ª—å–∑—É–π batch –º–µ—Ç–æ–¥—ã –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- OAuth 2.0 –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–µ webhook secret)

**Best practices:**
- –•—Ä–∞–Ω–∏ access_token –≤ secure storage
- –ò—Å–ø–æ–ª—å–∑—É–π webhooks –¥–ª—è —Å–æ–±—ã—Ç–∏–π, –Ω–µ polling
- –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ ‚Äî batch + queue

–•–æ—á–µ—à—å, –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é –ø–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏?"
```

---

## –ß–∞—Å—Ç—å 9: Implementation Roadmap

### Phase 1: Activity Foundation (2 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 1.1 | Activity entity + migration | P0 |
| 1.2 | ActivityMember entity | P0 |
| 1.3 | ActivityService CRUD | P0 |
| 1.4 | ActivityToolsProvider | P0 |
| 1.5 | Commitment entity | P1 |
| 1.6 | Seed initial areas/businesses | P1 |

### Phase 2: Daily ‚Üí Structure (2 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 2.1 | DailySynthesisExtractionService | P0 |
| 2.2 | Project inference from daily | P0 |
| 2.3 | Task extraction from daily | P0 |
| 2.4 | Commitment extraction | P1 |
| 2.5 | Confirmation UX –≤ Telegram | P0 |

### Phase 3: Context & Reasoning (2-3 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 3.1 | Context inference (work/personal) | P0 |
| 3.2 | Activity linking to messages | P0 |
| 3.3 | InferenceService framework | P1 |
| 3.4 | /daily —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ activity | P0 |

### Phase 4: Triggers (2 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 4.1 | Trigger entity + scheduler | P0 |
| 4.2 | Deadline triggers | P0 |
| 4.3 | Commitment overdue triggers | P1 |
| 4.4 | Incoming call context | P2 |

### Phase 5: Actions (2 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 5.1 | Action framework | P0 |
| 5.2 | Approval flow UI | P0 |
| 5.3 | Draft message action | P1 |
| 5.4 | Activity management actions | P1 |

### Phase 6: External Knowledge (1-2 –Ω–µ–¥–µ–ª–∏)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-----------|
| 6.1 | WebSearch tool integration | P1 |
| 6.2 | Answer augmentation | P1 |
| 6.3 | Documentation fetching | P2 |

---

## –ß–∞—Å—Ç—å 10: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 10.1 Mapping ExtractedEvent ‚Üí Activity/Commitment

```typescript
// ExtractedEvent.TASK ‚Üí Activity (type=task)
// ExtractedEvent.PROMISE_BY_ME ‚Üí Commitment (type=promise, from=owner)
// ExtractedEvent.PROMISE_BY_THEM ‚Üí Commitment (type=promise, from=entity)
// ExtractedEvent.MEETING ‚Üí EntityEvent (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
// ExtractedEvent.FACT ‚Üí EntityFact (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
```

### 10.2 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- EntityEvent –æ—Å—Ç–∞—ë—Ç—Å—è –¥–ª—è calendar events
- EntityFact –æ—Å—Ç–∞—ë—Ç—Å—è –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- Activity ‚Äî –Ω–æ–≤—ã–π —Å–ª–æ–π –¥–ª—è "–¥–µ–ª"
- Commitment ‚Äî –Ω–æ–≤—ã–π —Å–ª–æ–π –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤

---

## –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–∞—Ç—å —Å Phase 1.1 ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ Activity entity –∏ –º–∏–≥—Ä–∞—Ü–∏–∏.

```bash
git checkout -b feat/activity-foundation
```

–°–æ–∑–¥–∞—Ç—å:
1. `packages/entities/src/activity.entity.ts`
2. `packages/entities/src/activity-member.entity.ts`
3. Migration script
4. Basic ActivityService

–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å?
